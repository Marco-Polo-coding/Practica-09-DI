import{R as _}from"./index.D15Q2Owl.js";const C=n=>{let o;const t=new Set,r=(i,h)=>{const g=typeof i=="function"?i(o):i;if(!Object.is(g,o)){const S=o;o=h??(typeof g!="object"||g===null)?g:Object.assign({},o,g),t.forEach(f=>f(o,S))}},s=()=>o,u={setState:r,getState:s,getInitialState:()=>d,subscribe:i=>(t.add(i),()=>t.delete(i))},d=o=n(r,s,u);return u},R=n=>n?C(n):C,j=n=>n;function q(n,o=j){const t=_.useSyncExternalStore(n.subscribe,()=>o(n.getState()),()=>o(n.getInitialState()));return _.useDebugValue(t),t}const H=n=>{const o=R(n),t=r=>q(o,r);return Object.assign(t,o),t},w=n=>n?H(n):H;function x(n,o){let t;try{t=n()}catch{return}return{getItem:s=>{var e;const m=d=>d===null?null:JSON.parse(d,void 0),u=(e=t.getItem(s))!=null?e:null;return u instanceof Promise?u.then(m):m(u)},setItem:(s,e)=>t.setItem(s,JSON.stringify(e,void 0)),removeItem:s=>t.removeItem(s)}}const p=n=>o=>{try{const t=n(o);return t instanceof Promise?t:{then(r){return p(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return p(r)(t)}}}},E=(n,o)=>(t,r,s)=>{let e={storage:x(()=>localStorage),partialize:a=>a,version:0,merge:(a,I)=>({...I,...a}),...o},m=!1;const u=new Set,d=new Set;let i=e.storage;if(!i)return n((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...a)},r,s);const h=()=>{const a=e.partialize({...r()});return i.setItem(e.name,{state:a,version:e.version})},g=s.setState;s.setState=(a,I)=>{g(a,I),h()};const S=n((...a)=>{t(...a),h()},r,s);s.getInitialState=()=>S;let f;const b=()=>{var a,I;if(!i)return;m=!1,u.forEach(c=>{var l;return c((l=r())!=null?l:S)});const y=((I=e.onRehydrateStorage)==null?void 0:I.call(e,(a=r())!=null?a:S))||void 0;return p(i.getItem.bind(i))(e.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==e.version){if(e.migrate){const l=e.migrate(c.state,c.version);return l instanceof Promise?l.then(v=>[!0,v]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[v,O]=c;if(f=e.merge(O,(l=r())!=null?l:S),t(f,!0),v)return h()}).then(()=>{y?.(f,void 0),f=r(),m=!0,d.forEach(c=>c(f))}).catch(c=>{y?.(void 0,c)})};return s.persist={setOptions:a=>{e={...e,...a},a.storage&&(i=a.storage)},clearStorage:()=>{i?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>b(),hasHydrated:()=>m,onHydrate:a=>(u.add(a),()=>{u.delete(a)}),onFinishHydration:a=>(d.add(a),()=>{d.delete(a)})},e.skipHydration||b(),f||S},F=E,N=w(F((n,o)=>({cartItems:[],addToCart:t=>{const r=o().cartItems.find(s=>s.id===t.id);n(r?s=>({cartItems:s.cartItems.map(e=>e.id===t.id?{...e,quantity:e.quantity+1}:e)}):s=>({cartItems:[...s.cartItems,{...t,quantity:1}]}))},removeFromCart:t=>n(r=>({cartItems:r.cartItems.filter(s=>s.id!==t)})),clearCart:()=>n({cartItems:[]}),getCartTotal:()=>o().cartItems.reduce((t,r)=>t+r.quantity*r.price,0)}),{name:"cart-storage"}));export{w as c,N as u};
